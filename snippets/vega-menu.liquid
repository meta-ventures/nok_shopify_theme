{% assign child_list_handle = link.title | handleize %}
{% if linklists[child_list_handle].links != '' %}
<li class="menu-link parant">
  <a href="{{ link.url }}" class="link-title">
    {% assign collection =  link.object %}
    {% if section.settings.collection_img_enable %}
    {% if collection.image %}
    <img width="{{ collection.image.width }}" height="{{ collection.image.height }}" class="img-fluid" src="{{ collection | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}"/>
    {% else %}
    <img width="{{ collection.products.first.image.width }}" height="{{ collection.products.first.image.height }}" class="img-fluid" src="{{ collection.products.first | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}" />
    {% endif %}
    {% endif %}
    <span class="sp-link-title">{{ link.title }}</span>
    <i class="ri-arrow-down-s-line"></i>
  </a>
  <a href="#vega-collapse-{{ link.title | handleize }}" data-bs-toggle="collapse" class="link-title link-title-lg">
    {% assign collection =  link.object %}
    {% if section.settings.collection_img_enable %}
    {% if collection.image %}
    <img width="{{ collection.image.width }}" height="{{ collection.image.height }}" class="img-fluid" src="{{ collection | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}"/>
    {% else %}
    <img width="{{ collection.products.first.image.width }}" height="{{ collection.products.first.image.height }}" class="img-fluid" src="{{ collection.products.first | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}" />
    {% endif %}
    {% endif %}
    <span class="sp-link-title">{{ link.title }}</span>
    <i class="ri-arrow-down-s-line"></i>
  </a>
  <ul class="dropdown-submenu collapse" id="vega-collapse-{{ link.title | handleize }}">
    {% for childlink in linklists[child_list_handle].links %}
    {% assign grand_childlink_handle = childlink.title | handle %}
    {% if linklists[grand_childlink_handle] and linklists[grand_childlink_handle].links.size > 0 %}
    <li class="megamenu-li parant">
      <h2 class="sublink-title">{{ childlink.title }}</h2>
      <a href="{{ childlink.url }}" class="sublink-title">
        <span class="sp-link-title">{{ childlink.title }}</span>
        <i class="ri-arrow-down-s-line"></i>
      </a>
      <a href="#vega-collapse-{{ childlink.title | handleize }}" data-bs-toggle="collapse" class="sublink-title sublink-title-lg">
        <span class="spb-link-title">{{ childlink.title }}</span>
        <i class="ri-arrow-down-s-line"></i>
      </a>
      <ul class="dropdown-supmenu collapse" id="vega-collapse-{{ childlink.title | handleize }}">
        {% for grand_childlink_handle in linklists[grand_childlink_handle].links %}
        <li class="supmenu-li">
          <a href="{{ grand_childlink_handle.url }}" class="suplink-title">
            <span class="spbp-link-title">{{ grand_childlink_handle.title }}</span>
          </a>
        </li>
        {% endfor %}
      </ul>
    </li>

    {% else %}
    
    <li class="submenu-li parant{% if childlink.active %} active{% endif %}">
      <a href="{{ childlink.url }}" class="sublink-title">
        <span class="sp-link-title">{{ childlink.title }}</span>
      </a>
    </li>

    {% endif %}
    {% endfor %}
  </ul>
</li>
{% else %}
<li class="menu-link">
  <a href="{{ link.url }}" class="link-title">
    {% assign collection =  link.object %}
    {% if section.settings.collection_img_enable %}
    {% if collection.image %}
    <img width="{{ collection.image.width }}" height="{{ collection.image.height }}" class="img-fluid" src="{{ collection | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}"/>
    {% else %}
    <img width="{{ collection.products.first.image.width }}" height="{{ collection.products.first.image.height }}" class="img-fluid" src="{{ collection.products.first | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}" />
    {% endif %}
    {% endif %}
    <span class="sp-link-title">{{ link.title }}</span>
  </a>
  <a href="{{ link.url }}" class="link-title link-title-lg">
    {% assign collection =  link.object %}
    {% if section.settings.collection_img_enable %}
    {% if collection.image %}
    <img width="{{ collection.image.width }}" height="{{ collection.image.height }}" class="img-fluid" src="{{ collection | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}"/>
    {% else %}
    <img width="{{ collection.products.first.image.width }}" height="{{ collection.products.first.image.height }}" class="img-fluid" src="{{ collection.products.first | img_url: '25x25', crop: 'center' }}" alt="{{ collection.image.alt }}" />
    {% endif %}
    {% endif %}
    <span class="sp-link-title">{{ link.title }}</span>
  </a>
</li>
{% endif %}
<script>
  $('.submenu-li').parent('ul').addClass('sub-menu');
  $('.megamenu-li').parent('ul').addClass('mega-menu');
  $('.bannermenu-li').parent('ul').addClass('banner-menu');
</script>