{%- assign on_sale = false -%}
{%- if product.compare_at_price > product.price -%}
{%- assign on_sale = true -%}
{%- endif -%}
{%- assign sold_out = true -%}
{%- if product.available -%}
{%- assign sold_out = false -%}
{%- endif -%}
{%- assign variant = product.selected_or_first_available_variant -%}
{%- if product.available -%}
{%- assign func = "Shopify.addItem(" | append: variant.id | append: ", 1)" -%}
{%- endif -%}
<div class="product-content">
    <div class="row">
        <div class="col-xl-6 col-lg-6 col-md-6">
            <div class="product-image {% unless product.available %} stock-out{% endunless %}">
                <a class="pro-img" href="{{ product.url | within: collection }}">
                    <figure onmousemove="zoom(event)" style="background-image: url({{ product.featured_image.src | img_url: 'master' }}" alt="{{ product.featured_image.src.alt | escape }})">
                        <img width="{{ product.featured_image.width }}" height="{{ product.featured_image.height }}" id="featured-image-{{ product.id }}" class="img-fluid" src="{{ product.featured_image.src | img_url : '500x500',crop: 'center' }}" alt="{{ product.featured_image.src.alt | escape  }}">
                    </figure>
                </a>
                <div class="product-label">
                    {%- include 'product-label' -%}
                </div>
            </div>
        </div>
        <div class="col-xl-6 col-lg-6 col-md-6">
            <form action="/cart/add" method="post" class="cart" enctype="multipart/form-data"  id="add-item-form-{{variant.id}}">
                <div class="product-info">
                    {{ product.vendor | link_to_vendor: class: 'product-vendor' }}
                    <div class="product-title">
                        <a href="{{ product.url | within: collection }}" title="{{ product.title }}">{{ product.title }}</a>
                    </div>
                    {% if settings.pro_rew_enable %}
                    <div class="product-ratting">
                        <span class="shopify-product-reviews-badge" data-id="{{ product.id }}"></span>
                    </div>
                    {% endif %}
                    <div class="price-box">
                        <span class="new-price">{{ product.price | money }}</span>
                        {% if product.compare_at_price_max > product.price %}
                        <span class="old-price">{{ product.compare_at_price | money }}</span>
                        {% endif %}
                    </div>
                    <p class="product-description">
                        {{ product.description | strip_html | truncatewords: 25 }}
                    </p>
                    {%- if product.metafields.my_fields.timer -%}
                    <div class="timer-section counter-event-{{ product.id }}" id="counter-event" data-enddate="{{ product.metafields.my_fields.timer }}">
                        {{ product.metafields.my_fields.timer }}
                    </div>
                    {%- endif -%}
                    <input value="{{variant.id}}" type="hidden" name="id">
                    <div class="product-quantity">
                        {{ 'products.product.quantity' | t }}
                        <div class="cart-plus-minus">
                            <input value="1" type="text" name="quantity" min="1" pattern="[0-9]*">
                        </div>
                    </div>
                    <div class="product-action">
                        {% if product.available %}
                        <a href="javascript:void(0);" id="cart-{{variant.id}}" class="add-to-cart ajax-spin-cart">
                            <span class="cart-title">{{ settings.cart_button_title }}</span>
                            <span class="cart-loading load-anim"><i class="ri-loader-4-line"></i></span>
                            <span class="cart-added"><i class="ri-check-line"></i></span>
                            <span class="cart-unavailable"><i class="ri-alert-line"></i></span>
                        </a>
                        {% else %}
                        <a href="javascript:void(0);" class="disabled-add-to-cart add-to-cart disabled">
                            <i class="ri-shopping-cart-line"></i>
                        </a>
                        {% endif %}
                        {%- if settings.wishlist_enable -%}
                        {% include 'wishlist-button' %}
                        {%- endif -%}
                    </div>
                    <script>
                        $('#cart-{{variant.id}}').on('click', function() {
                            var $ = jQuery;
                            var formParams = $(this).parent().parent().parent('form.cart').serialize();
                        //e.preventDefault();
                        Shopify.addItemFromForm('add-item-form-{{variant.id}}');
                        });
                    </script>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    function zoom(e){
        var zoomer = e.currentTarget;
        e.offsetX ? offsetX = e.offsetX : offsetX = e.touches[0].pageX
        e.offsetY ? offsetY = e.offsetY : offsetX = e.touches[0].pageX
        x = offsetX/zoomer.offsetWidth*100
        y = offsetY/zoomer.offsetHeight*100
        zoomer.style.backgroundPosition = x + '% ' + y + '%';
    }
    $('.counter-event-{{product.id}}').countdown($('.counter-event-{{product.id}}').attr("data-enddate")).on('update.countdown', function (event) {
        var $this = $(this).html(event.strftime('' + '<ul class="contdown_row"><li class="countdown_section"><span id="days" class="countdown_timer">%-D</span>{% if settings.count_text_enable %}<span class="countdown_title">{{ settings.day_title }}</span>{% endif %}</li>' + '<li class="countdown_section"><span id="hours" class="countdown_timer">%H</span>{% if settings.count_text_enable %}<span class="countdown_title">{{ settings.hour_title }}</span>{% endif %}</li>' + '<li class="countdown_section"><span id="minutes" class="countdown_timer">%M</span>{% if settings.count_text_enable %}<span class="countdown_title">{{ settings.minute_title }}</span>{% endif %}</li>' + '<li class="countdown_section"><span id="seconds" class="countdown_timer">%S</span>{% if settings.count_text_enable %}<span class="countdown_title">{{ settings.second_title }}</span>{% endif %}</li></ul>'))
    });
</script>